<?xml version="1.0" ?>
<sdf version="1.8">

	<model name='lance'>

		<!-- <pose relative_to='world'>0 0 0 0 0 0</pose> -->

		<!-- <link name = 'test_link'>
			<pose relative_to = '__model__'>0 0 0 0 0 0</pose>
			<visual name = 'test_visual'>
				<geometry>
					<mesh>
						<uri>/mnt/c/users/hoodi/downloads/lance-2024-right-track.dae</uri>
						<scale>3 3 3</scale>
					</mesh>
				</geometry>
			</visual>
		</link> -->

	<!-- FRAME -->
		<link name = 'core_link'>
			<pose relative_to = '__model__'>0 0 0.13103567 0 0 0</pose>

			<inertial>
				<mass>9.773</mass>
				<inertia>
					<ixx> 0.909 </ixx>
					<ixy> -0.0001142 </ixy>
					<ixz> -0.2698 </ixz>
					<iyy> 1.129 </iyy>
					<iyz> 0.002 </iyz>
					<izz> 1.479 </izz>
				</inertia>
			</inertial>

			<visual name = 'core_visual'>
				<geometry>
					<mesh>
						<uri>./meshes/lance-2024-frame.dae</uri>
						<scale>1 1 1</scale>
					</mesh>
				</geometry>
			</visual>

			<collision name = 'core_collision'>
				<geometry>
					<mesh>
						<uri>./meshes/lance-2024-frame-collision.stl</uri>
						<scale>1 1 1</scale>
					</mesh>
				</geometry>
			</collision>
		</link>

	<!-- LEFT TRACK -->
		<link name = 'left_track_link'>
			<pose relative_to = 'core_link'>0.20318559 0.28988800 0.00242022 0 0 0</pose>

			<inertial>
				<mass>6.925</mass>
				<inertia>
					<ixx> 0.073 </ixx>
					<ixy> 0.0008 </ixy>
					<ixz> -0.032 </ixz>
					<iyy> 0.366 </iyy>
					<iyz> 0.0006 </iyz>
					<izz> 0.3 </izz>
				</inertia>
			</inertial>

			<visual name = 'left_track_visual'>
				<geometry>
					<mesh>
						<uri>./meshes/lance-2024-left-track.dae</uri>
						<scale>1 1 1</scale>
					</mesh>
				</geometry>
			</visual>

			<collision name = 'left_track_collision'>
				<geometry>
					<mesh>
						<uri>./meshes/lance-2024-left-track-collision.stl</uri>
						<scale>1 1 1</scale>
					</mesh>
				</geometry>
			</collision>
		</link>

		<joint name = 'left_track_joint' type = 'fixed'>
			<parent>core_link</parent>
			<child>left_track_link</child>
		</joint>

	<!-- RIGHT TRACK -->
		<link name = 'right_track_link'>
			<pose relative_to = 'core_link'>0.20318559 -0.28988800 0.00242022 0 0 0</pose>

			<inertial>
				<mass>6.925</mass>
				<inertia>
					<ixx> 0.073 </ixx>
					<ixy> -0.0006 </ixy>
					<ixz> -0.032 </ixz>
					<iyy> 0.366 </iyy>
					<iyz> -0.0005 </iyz>
					<izz> 0.3 </izz>
				</inertia>
			</inertial>

			<visual name = 'right_track_visual'>
				<geometry>
					<mesh>
						<uri>./meshes/lance-2024-right-track.dae</uri>
						<scale>1 1 1</scale>
					</mesh>
				</geometry>
			</visual>

			<collision name = 'right_track_collision'>
				<geometry>
					<mesh>
						<uri>./meshes/lance-2024-right-track-collision.stl</uri>
						<scale>1 1 1</scale>
					</mesh>
				</geometry>
			</collision>
		</link>

		<joint name = 'right_track_joint' type = 'fixed'>
			<parent>core_link</parent>
			<child>right_track_link</child>
		</joint>

	<!-- Excavation and Dump Unit -->
		<link name = 'collection_link'>
			<pose relative_to = 'core_link'>-0.45721441 0 0.18580822 0 -0.2617994 0</pose>

			<inertial>
				<mass>20.352</mass>
				<inertia>
					<ixx> 1 </ixx>
					<ixy> -0.122 </ixy>
					<ixz> 0.281 </ixz>
					<iyy> 2.457 </iyy>
					<iyz> 0.027 </iyz>
					<izz> 2.431 </izz>
				</inertia>
			</inertial>

			<visual name = 'hopper_visual'>
				<geometry>
					<mesh>
						<uri>./meshes/lance-2024-hopper.dae</uri>
						<scale>1 1 1</scale>
					</mesh>
				</geometry>
			</visual>
			<visual name = 'collection_visual'>
				<geometry>
					<mesh>
						<uri>./meshes/lance-2024-collection.dae</uri>
						<scale>1 1 1</scale>
					</mesh>
				</geometry>
			</visual>

			<collision name = 'collection_collision'>
				<geometry>
					<mesh>
						<uri>./meshes/lance-2024-upper-collision.stl</uri>
						<scale>1 1 1</scale>
					</mesh>
				</geometry>
			</collision>
		</link>

		<joint name = 'dump_joint' type = 'revolute'>
			<parent>core_link</parent>
			<child>collection_link</child>
			<axis>
				<xyz>0 1 0</xyz>
				<limit>
					<upper>0.2617994</upper>
					<lower>-0.2617994</lower>
				</limit>
			</axis>
		</joint>

	<!-- LIDAR -->
		<link name = 'lidar_link'>
			<pose relative_to = 'core_link'>0.64957717 0 0.42478867 3.1415926 0.3490659 0</pose>

			<inertial>
				<mass>0.7</mass>
				<inertia>
					<ixx> 0.001 </ixx>
					<ixy> 2e-8 </ixy>
					<ixz> 4e-7 </ixz>
					<iyy> 0.001 </iyy>
					<iyz> -3e-5 </iyz>
					<izz> 0.001 </izz>
				</inertia>
			</inertial>

			<visual name = 'lidar_visual'>
				<geometry>
					<mesh>
						<uri>./meshes/lance-2024-multiscan.dae</uri>
						<scale>1 1 1</scale>
					</mesh>
				</geometry>
			</visual>

			<collision name = 'lidar_collision'>
				<pose relative_to = 'lidar_link'>0 0 -0.006 0 0 0</pose>
				<geometry>
					<!-- <mesh>
						<uri>./meshes/lance-2024-multiscan.dae</uri>
						<scale>1 1 1</scale>
					</mesh> -->
					<cylinder>
						<radius>0.048</radius>
						<length>0.098</length>
					</cylinder>
				</geometry>
			</collision>

			<sensor name='gpu_lidar' type='gpu_lidar'>
			<pose>0 0 0 0 0 0</pose>
				<topic>scan</topic>
				<gz_frame_id>lance/lidar_link</gz_frame_id>
				<update_rate>20</update_rate>
				<lidar>
					<!-- TODO: correct these values -->
					<scan>
						<horizontal>
							<samples>640</samples>
							<resolution>1</resolution>
							<min_angle>-1.396263</min_angle>
							<max_angle>1.396263</max_angle>
						</horizontal>
						<vertical>
							<samples>1</samples>
							<resolution>1</resolution>
							<min_angle>0.0</min_angle>
							<max_angle>0.0</max_angle>
						</vertical>
					</scan>
					<range>
						<min>0.08</min>
						<max>10.0</max>
						<resolution>0.01</resolution>
					</range>
				</lidar>
				<visualize>true</visualize>
			</sensor>
		</link>

		<joint name = 'lidar_joint' type = 'fixed'>
			<parent>core_link</parent>
			<child>lidar_link</child>
		</joint>

	</model>
</sdf>
